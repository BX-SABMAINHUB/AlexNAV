<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>AlexNAV | Explorador Privado</title>
    <style>
        :root { --main: #00d4ff; --bg: #0a0a0a; --panel: #161616; --text: #e0e0e0; }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: var(--text); font-family: 'Segoe UI', sans-serif; overflow: hidden; }

        /* CABECERA ESTILO STARTPAGE */
        header { 
            height: 65px; background: var(--panel); display: flex; align-items: center; 
            padding: 0 20px; border-bottom: 2px solid var(--main); z-index: 1000; position: relative;
        }
        #logo { color: var(--main); font-weight: bold; font-size: 1.5rem; margin-right: 25px; cursor: pointer; }
        
        .search-area { flex: 1; display: flex; align-items: center; background: #222; border-radius: 30px; padding: 5px 15px; border: 1px solid #333; }
        .search-area input { flex: 1; background: transparent; border: none; color: white; padding: 8px; outline: none; font-size: 1rem; }
        
        .nav-buttons { display: flex; gap: 10px; margin-left: 15px; }
        .btn { background: var(--main); color: black; border: none; padding: 8px 15px; border-radius: 20px; font-weight: bold; cursor: pointer; font-size: 0.8rem; }
        .btn-red { background: #ff4444; color: white; }

        /* CONTENEDORES DE PANTALLA COMPLETA */
        #main-view { height: calc(100vh - 67px); width: 100%; position: relative; }
        iframe { width: 100%; height: 100%; border: none; background: white; display: none; }
        
        /* RESULTADOS Y HISTORIAL */
        #home-screen { padding: 40px; display: flex; flex-direction: column; align-items: center; overflow-y: auto; height: 100%; box-sizing: border-box; }
        .results-box { width: 100%; max-width: 900px; min-height: 400px; }
        
        .history-panel { width: 100%; max-width: 900px; margin-top: 30px; background: var(--panel); padding: 20px; border-radius: 15px; border: 1px solid #333; }
        .history-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #222; font-size: 0.9rem; }
        .history-item span { color: var(--main); cursor: pointer; }

        /* OCULTAR "OPTIMIZADO POR GOOGLE" */
        .gsc-control-cse { background: transparent !important; border: none !important; padding: 0 !important; }
        .gsc-adBlock, .gcsc-branding { display: none !important; } /* Esto borra la marca de Google */
        .gsc-search-button-v2 { display: none !important; } 
    </style>
</head>
<body>

<header>
    <div id="logo" onclick="irAHome()">AlexNAV</div>
    <div class="search-area">
        <input type="text" id="main-input" placeholder="Busca algo o pega un enlace (ej: wikipedia.org)..." onkeypress="checkEnter(event)">
    </div>
    <div class="nav-buttons">
        <button class="btn" onclick="procesarEntrada()">EXPLORAR</button>
        <button id="btn-cerrar" class="btn btn-red" style="display:none;" onclick="irAHome()">SALIR DE WEB</button>
    </div>
</header>

<div id="main-view">
    <div id="home-screen">
        <div class="results-box">
            <script async src="https://cse.google.com/cse.js?cx=b3588f8452e4c4301"></script>
            <div class="gcse-search"></div>
        </div>

        <div class="history-panel">
            <h3>Historial Reciente</h3>
            <div id="history-list"></div>
            <button class="btn btn-red" style="margin-top:15px; padding: 5px 10px;" onclick="limpiarHistorial()">Borrar todo</button>
        </div>
    </div>
    
    <iframe id="web-viewer"></iframe>
</div>

<script>
    // 1. LÓGICA DE BÚSQUEDA (URL O PALABRAS)
    function procesarEntrada() {
        const input = document.getElementById('main-input').value.trim();
        if(!input) return;

        // Si es una URL directa (ej: youtube.com)
        if (input.includes('.') && !input.includes(' ')) {
            const url = input.startsWith('http') ? input : 'https://' + input;
            abrirWeb(url);
        } else {
            // Si es búsqueda, usamos el motor interno
            const searchInput = document.querySelector('input.gsc-input');
            const searchBtn = document.querySelector('button.gsc-search-button');
            if(searchInput) {
                searchInput.value = input;
                searchBtn.click();
                irAHome(); // Asegura ver los resultados
            }
        }
        guardarHistorial(input);
    }

    function checkEnter(e) { if(e.key === 'Enter') procesarEntrada(); }

    // 2. NAVEGACIÓN EN LA MISMA PESTAÑA
    function abrirWeb(url) {
        const iframe = document.getElementById('web-viewer');
        const home = document.getElementById('home-screen');
        const btnCerrar = document.getElementById('btn-cerrar');

        home.style.display = 'none';
        iframe.src = url;
        iframe.style.display = 'block';
        btnCerrar.style.display = 'block';
    }

    function irAHome() {
        document.getElementById('web-viewer').style.display = 'none';
        document.getElementById('web-viewer').src = '';
        document.getElementById('home-screen').style.display = 'flex';
        document.getElementById('btn-cerrar').style.display = 'none';
    }

    // 3. SISTEMA DE HISTORIAL (LOCALSTORAGE)
    function guardarHistorial(item) {
        let history = JSON.parse(localStorage.getItem('alexnav_hist')) || [];
        history.unshift({texto: item, fecha: new Date().toLocaleTimeString()});
        if(history.length > 8) history.pop();
        localStorage.setItem('alexnav_hist', JSON.stringify(history));
        mostrarHistorial();
    }

    function mostrarHistorial() {
        const list = document.getElementById('history-list');
        const history = JSON.parse(localStorage.getItem('alexnav_hist')) || [];
        list.innerHTML = history.length ? '' : '<p style="color:#555">Historial vacío</p>';
        history.forEach(item => {
            list.innerHTML += `<div class="history-item"><span>${item.texto}</span> <small>${item.fecha}</small></div>`;
        });
    }

    function limpiarHistorial() {
        localStorage.removeItem('alexnav_hist');
        mostrarHistorial();
    }

    window.onload = mostrarHistorial;

    // CAPTURAR CLICS EN RESULTADOS
    document.addEventListener('click', function(e) {
        const link = e.target.closest('a.gs-title');
        if (link) {
            e.preventDefault();
            abrirWeb(link.href);
        }
    }, true);
</script>

</body>
</html>
